import React from 'react';
import { getSrcFromHtml, trimSnippet } from '../../utils/helperz';
import data from '../../data/popular.json';
import Card from '@material-ui/core/Card';
import CardActionArea from '@material-ui/core/CardActionArea';
import CardContent from '@material-ui/core/CardContent';
import CardMedia from '@material-ui/core/CardMedia';

const LatestRow = () => {

    const handleLinkClick = (linkout, e) => {
        e.preventDefault();
        window.open(linkout, '_blank');
    };

    const CardDeck = () => {
        let componentList = [];
        data.map((article, idx) => {
            if (idx >= 9) return null;
            let currentObj = {
                title: article.title,
                categories: article.categories,
                link: article.link,
                content: article.contentSnippet,
                html: article.content
            };
            componentList.push(currentObj);
            return null;
        });

        return (            
            componentList.map((article, i) => (
                <Card key={`article-card_${i}`} className='article-card'>
                    <CardActionArea onClick={(e) => handleLinkClick(article.link, e)} >
                        <CardContent className='card-body'>
                            <h2 className='card-title row-column-item-title'>{article.title}</h2>
                            <CardMedia component='img' src={getSrcFromHtml(article.html, true, 'lg')} />
                            <p className='card-text'>{trimSnippet(article.content)}</p>
                        </CardContent>
                    </CardActionArea>
                </Card>
            ))
        )
    };

    return (
        <div className='feed-row row__container'>
            <div className='bottom-border popular-title row-title'>Popular</div>
            <div className='card-deck'>
                <CardDeck />
            </div>
        </div>
    )
};

export default LatestRow;